<HTML><HEAD>
<TITLE>Project: FIRSTCOM.DPR</TITLE>
<META NAME="GENERATOR" CONTENT="PasToHTML[Marco Cantù]">
</HEAD>
<BODY BGCOLOR="#FFFFFF">
<CENTER><I>Marco Cant&ugrave; 1998, Mastering Delphi 4</I></CENTER>
<H1><CENTER>Project: FIRSTCOM.DPR</CENTER></H1><HR>
<H3>Project Structure</H3><UL>
<LI> <A HREF=#FIRSTCOM.DPR> FIRSTCOM.DPR</A>
<LI> <A HREF=#NUMINTF.PAS> NUMINTF.PAS</A>
<LI> <A HREF=#NUMSERV.PAS> NUMSERV.PAS</A>
<LI> <A HREF=#FIRSTCOM_TLB.PAS> FIRSTCOM_TLB.PAS</A>
</UL>
<HR>
<A NAME=FIRSTCOM.DPR><H3>FIRSTCOM.DPR</H3></A>

<PRE>
<B>library</B> FirstCom;

<B>uses</B>
  ComServ,
  NumIntf <B>in</B> <I>'NumIntf.pas'</I>,
  NumServ <B>in</B> <I>'NumServ.pas'</I>,
  Firstcom_TLB <B>in</B> <I>'Firstcom_TLB.pas'</I>;

<B>exports</B>
  DllGetClassObject,
  DllCanUnloadNow,
  DllRegisterServer,
  DllUnregisterServer;

<FONT COLOR="#000080"><I>{$R *.RES}</I></FONT>

<B>begin</B>
<B>end</B>.</PRE>
<HR>

<A NAME=NUMINTF.PAS><H3>NUMINTF.PAS</H3></A>

<PRE>
<B>unit</B> NumIntf;

<B>interface</B>

<B>type</B>
  INumber = <B>interface</B>
    [<I>'{B4131140-7C2F-11D0-98D0-444553540000}'</I>]
    <B>function</B> GetValue: Integer; <B>stdcall</B>;
    <B>procedure</B> SetValue (New: Integer); <B>stdcall</B>;
    <B>procedure</B> Increase; <B>stdcall</B>;
  <B>end</B>;

<B>implementation</B>

<B>end</B>.</PRE>
<HR>

<A NAME=NUMSERV.PAS><H3>NUMSERV.PAS</H3></A>

<PRE>
<B>unit</B> NumServ;

<B>interface</B>

<B>uses</B>
  Windows, ActiveX, ComObj, NumIntf;

<B>type</B>
  TNumServer = <B>class</B>(TComObject, IUnknown, INumber)
  <B>private</B>
    fValue: Integer;
  <B>public</B>
    <B>function</B> GetValue: Integer; <B>virtual</B>; <B>stdcall</B>;
    <B>procedure</B> SetValue (New: Integer); <B>virtual</B>; <B>stdcall</B>;
    <B>procedure</B> Increase; <B>virtual</B>; <B>stdcall</B>;
    <B>procedure</B> Initialize; <B>override</B>;
    <B>destructor</B> Destroy; <B>override</B>;
  <B>end</B>;

<B>const</B>
  Class_NumServer: TGUID =
    <I>'{22053AE1-DD08-11D1-B9F1-004845400FAA}'</I>;

<B>implementation</B>

<B>uses</B> ComServ;

<FONT COLOR="#000080"><I>{ TNumServer }</I></FONT>

<B>destructor</B> TNumServer.Destroy;
<B>begin</B>
  <B>inherited</B>;
  MessageBox (0, <I>'Object Destroyed'</I>,
    <I>'TDLLNumber'</I>, mb_OK); <FONT COLOR="#000080"><I>// API call</I></FONT>
<B>end</B>;

<B>function</B> TNumServer.GetValue: Integer;
<B>begin</B>
  Result := fValue;
<B>end</B>;

<B>procedure</B> TNumServer.Increase;
<B>begin</B>
  Inc (fValue);
<B>end</B>;

<B>procedure</B> TNumServer.Initialize;
<B>begin</B>
  <B>inherited</B>;
  fValue := 10;
<B>end</B>;

<B>procedure</B> TNumServer.SetValue(New: Integer);
<B>begin</B>
  fValue := New;
 <B>end</B>;

<B>initialization</B>
  TComObjectFactory.Create(ComServer, TNumServer, Class_NumServer,
    <I>'NumServer'</I>, <I>'Num Server (First Com)'</I>, ciMultiInstance, tmSingle);
<B>end</B>.</PRE>
<HR>

<A NAME=FIRSTCOM_TLB.PAS><H3>FIRSTCOM_TLB.PAS</H3></A>

<PRE>
</PRE>
<HR>

<BR><I><CENTER>Copyright Marco Cant&ugrave; 1998</CENTER></I>
</BODY> </HTML>