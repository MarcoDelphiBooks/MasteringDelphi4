<HTML><HEAD>
<TITLE>Project: CTRLBAR.DPR</TITLE>
<META NAME="GENERATOR" CONTENT="PasToHTML[Marco Cantù]">
</HEAD>
<BODY BGCOLOR="#FFFFFF">
<CENTER><I>Marco Cant&ugrave; 1998, Mastering Delphi 4</I></CENTER>
<H1><CENTER>Project: CTRLBAR.DPR</CENTER></H1><HR>
<H3>Project Structure</H3><UL>
<LI> <A HREF=#CTRLBAR.DPR> CTRLBAR.DPR</A>
<LI> <A HREF=#CTRLFORM.PAS> CTRLFORM.PAS</A>
<LI> <A HREF=#CTRLFORM.DFM> CTRLFORM.DFM</A>
</UL>
<HR>
<A NAME=CTRLBAR.DPR><H3>CTRLBAR.DPR</H3></A>

<PRE>
<B>program</B> CtrlBar;

<B>uses</B>
  Forms,
  CtrlForm <B>in</B> <I>'CtrlForm.pas'</I> <FONT COLOR="#000080"><I>{Form1}</I></FONT>;

<FONT COLOR="#000080"><I>{$R *.RES}</I></FONT>

<B>begin</B>
  Application.Initialize;
  Application.CreateForm(TForm1, Form1);
  Application.Run;
<B>end</B>.</PRE>
<HR>

<A NAME=CTRLFORM.PAS><H3>CTRLFORM.PAS</H3></A>

<PRE>
<B>unit</B> CtrlForm;

<B>interface</B>

<B>uses</B>
  Windows, Messages, SysUtils, Classes, Graphics, Controls, Forms, Dialogs,
  Buttons, StdCtrls, ExtCtrls, Menus, ComCtrls, ToolWin, ImgList;

<B>type</B>
  TForm1 = <B>class</B>(TForm)
    ControlBar: TControlBar;
    ComboFont: TComboBox;
    Label1: TLabel;
    ImageList1: TImageList;
    ToolFontStyle: TToolBar;
    tbBold: TToolButton;
    tbitalic: TToolButton;
    tbUnderline: TToolButton;
    ToolAlign: TToolBar;
    tbNote: TToolButton;
    ToolButton9: TToolButton;
    tbLeft: TToolButton;
    tbCenter: TToolButton;
    tbRight: TToolButton;
    <B>procedure</B> tbLeftClick(Sender: TObject);
    <B>procedure</B> tbCenterClick(Sender: TObject);
    <B>procedure</B> tbRightClick(Sender: TObject);
    <B>procedure</B> tbNoteClick(Sender: TObject);
    <B>procedure</B> tbBoldClick(Sender: TObject);
    <B>procedure</B> tbitalicClick(Sender: TObject);
    <B>procedure</B> tbUnderlineClick(Sender: TObject);
    <B>procedure</B> FormCreate(Sender: TObject);
    <B>procedure</B> ComboFontChange(Sender: TObject);
  <B>private</B>
    <FONT COLOR="#000080"><I>{ Private declarations }</I></FONT>
  <B>public</B>
    <FONT COLOR="#000080"><I>{ Public declarations }</I></FONT>
  <B>end</B>;

<B>var</B>
  Form1: TForm1;

<B>implementation</B>

<FONT COLOR="#000080"><I>{$R *.DFM}</I></FONT>

<B>procedure</B> TForm1.tbLeftClick(Sender: TObject);
<B>begin</B>
  Label1.Alignment := taLeftJustify;
<B>end</B>;

<B>procedure</B> TForm1.tbCenterClick(Sender: TObject);
<B>begin</B>
  Label1.Alignment := taCenter;
<B>end</B>;

<B>procedure</B> TForm1.tbRightClick(Sender: TObject);
<B>begin</B>
  Label1.Alignment := taRightJustify;
<B>end</B>;

<B>procedure</B> TForm1.tbNoteClick(Sender: TObject);
<B>begin</B>
  Beep;
<B>end</B>;

<B>procedure</B> TForm1.tbBoldClick(Sender: TObject);
<B>begin</B>
  <B>with</B> Label1.Font <B>do</B>
    <B>if</B> fsBold <B>in</B> Style <B>then</B>
      Style := Style - [fsBold]
    <B>else</B>
      Style := Style + [fsBold];
<B>end</B>;

<B>procedure</B> TForm1.tbitalicClick(Sender: TObject);
<B>begin</B>
  <B>with</B> Label1.Font <B>do</B>
    <B>if</B> fsItalic <B>in</B> Style <B>then</B>
      Style := Style - [fsItalic]
    <B>else</B>
      Style := Style + [fsItalic];
<B>end</B>;

<B>procedure</B> TForm1.tbUnderlineClick(Sender: TObject);
<B>begin</B>
  <B>with</B> Label1.Font <B>do</B>
    <B>if</B> fsUnderline <B>in</B> Style <B>then</B>
      Style := Style - [fsUnderline]
    <B>else</B>
      Style := Style + [fsUnderline];
<B>end</B>;

<B>procedure</B> TForm1.FormCreate(Sender: TObject);
<B>begin</B>
  ComboFont.Items := Screen.Fonts;
  ComboFont.ItemIndex :=
    ComboFont.Items.IndexOf (Label1.Font.Name);
<B>end</B>;

<B>procedure</B> TForm1.ComboFontChange(Sender: TObject);
<B>begin</B>
  Label1.Font.Name := ComboFont.Text;
<B>end</B>;

<B>end</B>.</PRE>
<HR>

<A NAME=CTRLFORM.DFM><H3>CTRLFORM.DFM</H3></A>

<PRE>
<B>object</B> Form1: TForm1
  Left = 193
  Top = 107
  Width = 671
  Height = 392
  Caption = <I>'CtrlBar (Control Bar Demo)'</I>
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -11
  Font.Name = <I>'MS Sans Serif'</I>
  Font.Style = []
  OldCreateOrder = False
  OnCreate = FormCreate
  PixelsPerInch = 96
  TextHeight = 13
  <B>object</B> Label1: TLabel
    Left = 0
    Top = 30
    Width = 663
    Height = 335
    Align = alClient
    Caption =
       <I>'A caption with some sample text to show the effect of the speed '</I> +
      <I>'buttons of the toolbar. You can replace it with something more u'</I> +
      <I>'seful.'</I>
    Font.Charset = DEFAULT_CHARSET
    Font.Color = clBlack
    Font.Height = -19
    Font.Name = <I>'Arial'</I>
    Font.Style = []
    ParentFont = False
    WordWrap = True
  <B>end</B>
  <B>object</B> ControlBar: TControlBar
    Left = 0
    Top = 0
    Width = 663
    Height = 30
    Align = alTop
    AutoDrag = False
    AutoSize = True
    DockSite = False
    DragKind = dkDock
    RowSize = 25
    RowSnap = False
    TabOrder = 0
    <B>object</B> ComboFont: TComboBox
      Left = 214
      Top = 2
      Width = 167
      Height = 21
      Style = csDropDownList
      ItemHeight = 13
      TabOrder = 0
      OnChange = ComboFontChange
    <B>end</B>
    <B>object</B> ToolFontStyle: TToolBar
      Left = 129
      Top = 2
      Width = 72
      Height = 22
      AutoSize = True
      EdgeBorders = []
      EdgeInner = esNone
      EdgeOuter = esNone
      Flat = True
      Images = ImageList1
      TabOrder = 1
      <B>object</B> tbBold: TToolButton
        Left = 0
        Top = 0
        Caption = <I>'tbBold'</I>
        ImageIndex = 4
        Style = tbsCheck
        OnClick = tbBoldClick
      <B>end</B>
      <B>object</B> tbitalic: TToolButton
        Left = 23
        Top = 0
        Caption = <I>'tbitalic'</I>
        ImageIndex = 5
        Style = tbsCheck
        OnClick = tbitalicClick
      <B>end</B>
      <B>object</B> tbUnderline: TToolButton
        Left = 46
        Top = 0
        Caption = <I>'tbUnderline'</I>
        ImageIndex = 6
        Style = tbsCheck
        OnClick = tbUnderlineClick
      <B>end</B>
    <B>end</B>
    <B>object</B> ToolAlign: TToolBar
      Left = 11
      Top = 2
      Width = 105
      Height = 22
      AutoSize = True
      EdgeBorders = []
      EdgeInner = esNone
      EdgeOuter = esNone
      Flat = True
      Images = ImageList1
      TabOrder = 2
      <B>object</B> tbNote: TToolButton
        Left = 0
        Top = 0
        Caption = <I>'ToolButton3'</I>
        ImageIndex = 0
        OnClick = tbNoteClick
      <B>end</B>
      <B>object</B> ToolButton9: TToolButton
        Left = 23
        Top = 0
        Width = 8
        Caption = <I>'ToolButton6'</I>
        ImageIndex = 3
        Style = tbsSeparator
      <B>end</B>
      <B>object</B> tbLeft: TToolButton
        Left = 31
        Top = 0
        Caption = <I>'ToolButton4'</I>
        Grouped = True
        ImageIndex = 1
        OnClick = tbLeftClick
      <B>end</B>
      <B>object</B> tbCenter: TToolButton
        Left = 54
        Top = 0
        Caption = <I>'ToolButton5'</I>
        Grouped = True
        ImageIndex = 2
        OnClick = tbCenterClick
      <B>end</B>
      <B>object</B> tbRight: TToolButton
        Left = 77
        Top = 0
        Caption = <I>'ToolButton7'</I>
        Grouped = True
        ImageIndex = 3
        OnClick = tbRightClick
      <B>end</B>
    <B>end</B>
  <B>end</B>
  <B>object</B> ImageList1: TImageList
    Left = 32
    Top = 88
    Bitmap = <FONT COLOR="#000080"><I>{
      360C000007000000424D360C0000000000003604000028000000400000002000
      0000010008000000000000080000000000000000000000010000000000000000
      0000000080000080000000808000800000008000800080800000C0C0C000C0DC
      C000F0CAA6000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
</I></FONT>      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      00000000000000000000000000000000000000000000F0FBFF00A4A0A0008080
      80000000FF0000FF000000FFFF00FF000000FF00FF00FFFF0000FFFFFF000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000070707070707070707070707070707070000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000070707070707070707070707070707070000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000000000000007070707070707070707070707F8FF070000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000070707070707070707070707070707070000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000070707070707070707070707070707070000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000070707070707070707070707070707070000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000070707070707070707070707070707070000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000070707070707070707070707070707070000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000070707070707070707070707070707070000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000070707070707070707070707070707070000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000070707070707070707070707070707070000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000070707070707070707070707070707070000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000070707070707070707070707070707070000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000070707070707070707070707070707070000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000070707070707070707070707070707070000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000070707070707070707070707070707070000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000000000000000000000000000000000000000000000424D
      3E010000000000003E0000002800000040000000200000000100010000000000
      000100000000000000000000020000000000000000000000FFFFFF00FFFFFFFF
      FFFF0000FFFFFFFFFFFFF800E01FF03FF00F0000E00FFCFFF00FF800F3CFFCFF
      FFFFF800F3CFFCFFFC4F00F8F38FFE7FF80F0000F01FFE7FF91FF800F00FFE7F
      F99F0000F3CFFF3FF99FF803F3CFFF3FF99FF800E00FFC0FF11FF803E01FFFFF
      FFFF0000FFFFFFFFFFFF0003FFFFFFFFFFFF0000FFFFFFFFFFFF0100CFFF8001
      80018001873FBFFDBFFDBFFD821FA03DB81DBC05C20FBFFDBFFDBFFDFB0FA3FD
      BC3DBFC5FBEFBFFDBFFDBFFDFBEFA0FDB81DBF05FBEFBFFDBFFDBFFDFBEFA3FD
      BE7DBFC5FBEFBFFDBFFDBFFDF8EFA01DB00DB805FB0FBFFDBFFDBFFDF8EFA07D
      B81DBE05FF0FBFFDBFFDBFFDFFFF800180018001FFFFFFFFFFFFFFFF}
  <B>end</B>
<B>end</B></PRE>
<HR>

<BR><I><CENTER>Copyright Marco Cant&ugrave; 1998</CENTER></I>
</BODY> </HTML>